#!./.venv/bin/python
"""
Unified video uploader and processor for local files.
Usage: ./ul "local_file_path" "profile_id" [--DEV|--PROD] [--dry-run]
"""

import sys
import os
import logging
import argparse
from pathlib import Path

# Add current directory to path so we can import core
sys.path.append(os.path.dirname(os.path.abspath(__file__)))

from core.config import load_config, add_common_args
from core.pipeline import process_file_logic

# Configure logging
logging.basicConfig(
    level=logging.INFO, format="%(asctime)s - %(levelname)s - %(message)s"
)


def main():
    parser = argparse.ArgumentParser(description="Upload and process local video file.")
    parser.add_argument("file_path", help="Path to local video file")
    parser.add_argument("profile_id", help="Profile ID of the owner")
    add_common_args(parser)

    args = parser.parse_args()
    config = load_config(args)

    file_path = Path(args.file_path)
    profile_id = args.profile_id

    process_file_logic(
        file_path, profile_id, args.dry_run, config, lat=args.lat, lng=args.lng
    )


if __name__ == "__main__":
    main()
